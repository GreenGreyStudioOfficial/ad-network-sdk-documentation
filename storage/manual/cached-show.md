# Показ заранее закэшированной рекламы
В [предыдущей статье](fast-show.md) мы познакомились с методом [LazyLoad](../api/methods/LazyLoad.md). Главный его минус - отсутствие возможности закэшировать несколько рекламных объявлений. Зато метод [Load](../api/methods/Load.md) отлично справляется с этой задачей, однако со своими нюансами, о которых поговорим в данной статье.

Есть 2 момента, которые делают эту задачу не самой тривиальной:

1.  Получение актуального списка закэшированных рекламных объявлений (в том числе после перезапуска приложения)
    
2.  Обработка ошибок, связанных с истеканием сроков годности кэша и плавающим ограничением по максимальному кол-ву загрузки роликов.
    

И, в каждом из этих моментов, нам поможет метод [AdNetworkSDK.GetLoadedAdsIds](../api/methods/GetLoadedAdsIds.md), который возвращает список идентификаторов актуальных на момент вызова метода закэшированных креативов.

Этот метод - фактически прямой ответ на первую проблему, тут все вполне очевидно.

Теперь разберемся с обработкой ошибок.

Первое, с чем можем столкнуться - переполнение кэша (например, когда верхняя граница N креативов, а пытаемся загрузить N + 1). В этом случае, слушатель загрузки завершит работу с ошибкой [LoadErrorType.TO_MANY_VIDEOS_LOADED](../api/enums/LoadErrorType.md). Обработать ее можно следующим образом:

```
public class MyLoadListener : IAdLoadListener
{
    ........

    public void OnLoadError(
		LoadErrorType _error, string _id, string _errorMessage)
    {
        switch (_error)
            {
                case LoadErrorType.TO_MANY_VIDEOS_LOADED:
                    // Тут мы знаем, что кэш переполнен. Обрабатываем в соответствии с необходимой логикой
                    break;
                default:
                    // Тут мы знаем, что проблема не в переполнении кэша.
                    break;
            }
    }

    ........
    
}
```

Второй момент - между тем как рекламное объявление попадает в кэш и вызовом показа этого объявления может пройти время, превышающее время жизни этого кэша. В данном случае слушатель показа получит сообщение об ошибке [ShowErrorType.VIDEO_WAS_DELETED](../api/enums/ShowErrorType.md). Получение этой ошибки значит, что у нас не актуальная информация о закэшированных креативах и нужно обновить ее с помощью метода [AdNetworkSDK.GetLoadedAdsIds](../api/methods/GetLoadedAdsIds.md). Обработать это можно аналогичным методом:

```
public class MyShowListener : IAdShowListener
{

    ........
    
    public void OnShowError(
		string _id, ShowErrorType _error, string _errorMessage)
    {
        switch (_error)
            {
                case ShowErrorType.VIDEO_WAS_DELETED:
                    // Тут мы знаем, что наши данные устарели и их нужно обновить. Обрабатываем в соответствии с необходимой логикой
                    break;
                default:
                    // Тут мы знаем, что проблема не в устаревании кэша.
                    break;
            }
    }

    ........
    
}
```

На этом обзорное знакомство с SDK подходит к концу. Для более подробного знакомства с библиотекой сморите [Описание API](../api/api.md)

---

[<< назад](fast-show.md) [далее >>](../api/api.md)